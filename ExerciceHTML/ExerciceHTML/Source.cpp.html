<!DOCTYPE html><head></head><body>#include &lt;iostream&gt;<br>#include &lt;fstream&gt;<br>#include &lt;vector&gt;<br>#include &lt;string&gt;<br>#include &lt;map&gt;<br>#include &lt;regex&gt;<br>#include &lt;algorithm&gt;<br>#include &lt;sstream&gt;<br>#include &lt;chrono&gt;<br> <span style='color:blue'> using</span>  <span style='color:blue'> namespace</span> std;<br> <span style='color:blue'> using</span>  <span style='color:blue'> namespace</span> std::chrono;<br><br>vector&lt;string&gt; ReadFile( <span style='color:blue'> const</span> string&amp; filename);<br> <span style='color:blue'> void</span> setArguments( <span style='color:blue'> const</span>  <span style='color:blue'> int</span>&amp; argc,  <span style='color:blue'> char</span>* argv[], vector&lt;string&gt; &amp;SourceFiles, vector&lt;string&gt; &amp;Options);<br> <span style='color:blue'> void</span> Write( <span style='color:blue'> const</span> vector&lt;string&gt; &amp;words,  <span style='color:blue'> const</span> string &amp;filename);<br> <span style='color:blue'> void</span> Replace(vector&lt;string&gt; &amp;words,  <span style='color:blue'> const</span> vector&lt;string&gt; &amp;keywords,  <span style='color:blue'> bool</span> &amp;color);<br> <span style='color:blue'> void</span> addWords(vector&lt;string&gt; &amp;allWords,  <span style='color:blue'> const</span>  vector&lt;string&gt; &amp; words);<br> <span style='color:blue'> void</span> createStatsFile( <span style='color:blue'> const</span> vector&lt;string&gt; &amp;words);<br><br> <span style='color:blue'> int</span> main( <span style='color:blue'> int</span> argc,  <span style='color:blue'> char</span>* argv[])<br>{<br>&nbsp&nbsp&nbsp&nbsp;vector&lt;string&gt; Files;<br>&nbsp&nbsp&nbsp&nbsp;vector&lt;string&gt; Options;<br>&nbsp&nbsp&nbsp&nbsp;vector&lt;string&gt; allWords;<br>&nbsp&nbsp&nbsp&nbsp;setArguments(argc, argv, Files, Options);<br><br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> bool</span> color =  <span style='color:blue'> false</span>;<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> bool</span> stats =  <span style='color:blue'> false</span>;<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> unsigned</span>  <span style='color:blue'> int</span> i = 0; i &lt; Options.size(); ++i)<br>&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> if</span> (Options[i] == "couleur")<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;color =  <span style='color:blue'> true</span>;<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> else</span>  <span style='color:blue'> if</span> (Options[i] == "stats")<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;stats =  <span style='color:blue'> true</span>;<br>&nbsp&nbsp&nbsp&nbsp;}<br><br>&nbsp&nbsp&nbsp&nbsp;// s'il n'y a pas de fichier en paramètre, prendre ce fichier-ci<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> if</span> (!Files.empty())<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;Files.push_back("Source.cpp");<br><br>&nbsp&nbsp&nbsp&nbsp;vector&lt;string&gt; keywords = ReadFile("keywords.txt");<br><br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> unsigned</span>  <span style='color:blue'> int</span> i = 0; i &lt; Files.size(); ++i)<br>&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;vector&lt;string&gt; words = ReadFile(Files.at(i));<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;Replace(words,keywords, color);<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;Write(words, Files.at(i));<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;addWords(allWords, words);<br>&nbsp&nbsp&nbsp&nbsp;}<br>&nbsp&nbsp&nbsp&nbsp;<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> if</span> (stats)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;createStatsFile(allWords);<br>}<br><br> <span style='color:blue'> void</span> setArguments( <span style='color:blue'> const</span>  <span style='color:blue'> int</span>&amp; argc,  <span style='color:blue'> char</span>* argv[], vector&lt;string&gt; &amp;SourceFiles, vector&lt;string&gt; &amp;Options)<br>{<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> int</span> i = 0; i &lt; argc; ++i)<br>&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;string param = argv[i];<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> if</span> (param[0] == '-' || param[0] == '/')<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;Options.push_back(param.substr(1));<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> else</span><br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;SourceFiles.push_back(param);<br>&nbsp&nbsp&nbsp&nbsp;}<br>}<br><br>vector&lt;string&gt; ReadFile( <span style='color:blue'> const</span> string&amp; filename) <br>{<br>&nbsp&nbsp&nbsp&nbsp;vector&lt;string&gt; sentences;<br>&nbsp&nbsp&nbsp&nbsp;ifstream file(filename);<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> if</span> (file)<br>&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> (string line; getline(file, line);)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;sentences.push_back(line);<br>&nbsp&nbsp&nbsp&nbsp;}<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> return</span> sentences;<br>}<br><br> <span style='color:blue'> void</span> Write( <span style='color:blue'> const</span> vector&lt;string&gt; &amp;words, <span style='color:blue'> const</span> string &amp;filename)<br>{<br>&nbsp&nbsp&nbsp&nbsp;ofstream file(filename + ".html");<br>&nbsp&nbsp&nbsp&nbsp;file &lt;&lt; "&lt;!DOCTYPE html&gt;" &lt;&lt; "&lt;head&gt;&lt;/head&gt;&lt;body&gt;";<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> unsigned</span>  <span style='color:blue'> int</span> i = 0; i &lt; words.size(); ++i)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;file &lt;&lt; words.at(i) &lt;&lt; "&lt;br&gt;" &lt;&lt; flush;<br>&nbsp&nbsp&nbsp&nbsp;file &lt;&lt; "&lt;/body&gt;&lt;/html&gt;";<br>}<br><br> <span style='color:blue'> void</span> Replace(vector&lt;string&gt; &amp;words,  <span style='color:blue'> const</span> vector&lt;string&gt; &amp;keywords,  <span style='color:blue'> bool</span> &amp;color)<br>{<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span>( <span style='color:blue'> auto</span> debut = begin(words); debut != end(words); ++debut)<br>&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;*debut = regex_replace(*debut, regex{ "&amp;" }, "&amp;amp;");<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;*debut = regex_replace(*debut, regex{ "&lt;" }, "&amp;lt;");<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;*debut = regex_replace(*debut, regex{ "&gt;" }, "&amp;gt;");<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;*debut = regex_replace(*debut, regex{ "\\t" }, "&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp;");<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> if</span> (color)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> auto</span> keywordPos = begin(keywords); keywordPos != end(keywords); ++keywordPos)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;regex expression("\\b" + *keywordPos + "\\b");<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;*debut = regex_replace(*debut, expression, " &lt;span style='color:blue'&gt; " + *keywordPos + "&lt;/span&gt;");<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;}<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;}<br>&nbsp&nbsp&nbsp&nbsp;}<br><br>}<br><br> <span style='color:blue'> void</span> addWords(vector&lt;string&gt; &amp;allWords, <span style='color:blue'> const</span>  vector&lt;string&gt; &amp; words)<br>{<br>&nbsp&nbsp&nbsp&nbsp;allWords.insert(end(allWords), begin(words), end(words));<br>}<br><br> <span style='color:blue'> void</span> createStatsFile( <span style='color:blue'> const</span> vector&lt;string&gt; &amp;words)<br>{<br>&nbsp&nbsp&nbsp&nbsp;regex expression("\\d+\\.?\\d*|\\w+");<br>&nbsp&nbsp&nbsp&nbsp;map&lt;string,  <span style='color:blue'> int</span>&gt; stats;<br>&nbsp&nbsp&nbsp&nbsp;smatch match;<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> unsigned</span>  <span style='color:blue'> int</span> i = 0; i &lt; words.size(); ++i)<br>&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;string sentence = words[i];<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> while</span> (regex_search(sentence, match, expression))<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;{<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> auto</span>&amp; mot : match)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;stats[mot.str()]++;<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;sentence = match.suffix().str();<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;}<br>&nbsp&nbsp&nbsp&nbsp;}<br><br>&nbsp&nbsp&nbsp&nbsp;ofstream fichier("Stats.txt");<br>&nbsp&nbsp&nbsp&nbsp; <span style='color:blue'> for</span> ( <span style='color:blue'> auto</span> s = stats.begin(); s != stats.end(); s++)<br>&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp;fichier &lt;&lt; s-&gt;first &lt;&lt; " : " &lt;&lt; s-&gt;second &lt;&lt; endl;<br>}<br></body></html>